<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Title</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #1a202c;
            font-size: large;
        }
        header {
            background-color: #1f2733;
            color: white;
            padding: 20px;
            width: 70%;
            text-align: center;
        }
        .main-content {
            background-color: #1f2733;
            color: white;
            max-width: 800px;
            margin: 20px;
        }
        .last-updated {
            font-style: italic;
            margin-bottom: 20px;
        }
        #plot {
            width: 600px;
            height: 400px;
            background-color: #f0f0f0;
            margin: 20px;
        }
        form {
            display: flex;
            flex-direction: column;
            width: 300px;
            margin: 20px;
        }
        .input-group {
            margin-top: 20px;
        }
        label {
            font-weight: bold;
        }
        input {
            padding: 10px;
            margin-top: 20px;
        }
        button {
            padding: 10px;
            background-color: #1a202c;
            color: white;
            border: none;
            cursor: pointer;
            margin: 20px;
        }
        button:hover {
            background-color: #0039cb;
        }
    </style>
</head>
<body>
    <header>
        <h1>Reuse Concrete</h1>
        <div class="last-updated">Last updated on Feb 19, 2024</div>
    </header>
    <div class="main-content">
        <p>When envisioning the future of architecture, we tend to gravitate towards innovative technologies, new materials and advanced methods. However, people might overlook the potential of reusing existing materials and products. 
            Presently, there is an emerging momentum towards advocating the principles of a circular economy and reuse is considered as a preferred strategy due to its ability to extend the lifespan of existing products a
            This research focuses on the concept of concrete reuse as a sustainable strategy, examining the limitations for cutting dimensions. </p>
        <div id="plot"><!-- Plotly plot will be inserted here -->
            <div id="intersectionPointMessage"><!-- New element for displaying the intersection point -->
            </div>
        <!-- Place this inside your <div class="main-content"> -->

        <form id="inputForm">
            <div class="input-group">
                <label for="input1">Cutting Depth (m):</label>
                <input type="number" id="input1" name="input1" value="0.4">
            </div>
            <div class="input-group">
                <label for="input2">Cutting Width (m):</label>
                <input type="number" id="input2" name="input2" value="0.4">
            </div>
            <div class="input-group">
                <label for="input3">Cutting Speed (m<sup>2</sup>/hr) (with Hilti DST20A, normally 3-6 m<sup>2</sup>/hr):</label>
                <input type="number" id="input3" name="input3" value="6">
            </div>
            <div class="input-group">
                <label for="input4">Distance for Reuse (km):</label>
                <input type="number" id="input4" name="input4" value="100">
            </div>
            <div class="input-group">
                <label for="input5">Distance for New Material (km):</label>
                <input type="number" id="input5" name="input5" value="100">
            </div>
            <button type="button" onclick="submitInput()">Submit</button>
            
        </form>
    </div>


    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        // Function to handle form submission
        // Placeholder for the actual function that will process the input and update the plot
        function submitInput() {
            var input1 = document.getElementById('input1').value;
            var input2 = document.getElementById('input2').value;
            var input3 = document.getElementById('input3').value;
            var input4 = document.getElementById('input4').value;
            var input5 = document.getElementById('input5').value;
            
            // AJAX request to Flask
            fetch('/update_plot', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    input1: input1,
                    input2: input2,
                    input3: input3,
                    input4: input4,
                    input5: input5
                })
            })

            .then(response => response.json())
            .then(data => {
                // Plotly.newPlot('plot', JSON.parse(data));
                Plotly.newPlot('plot', JSON.parse(data.plot)); // Adjusted to access plot from response object
                // Update the intersection point message with limited decimal places
                //document.getElementById('intersectionPointMessage').innerHTML = `The optimal size of the reused piece is: ${parseFloat(data.intersection_points).toFixed(2)} mÂ³`; // Adjusted to display intersection point with 2 decimal places
              document.getElementById('intersectionPointMessage').innerHTML = `The optimal size of the reused piece is: ${data.intersection_point} m`; // Adjusted to display intersection point
            
               });
        }
        // Trigger the plot update with default values on page load
        document.addEventListener('DOMContentLoaded', submitInput);
    </script>

    <script src="https://threejs.org/build/three.js"></script>
    <script>
        
        function visualizeBeam(depth, width, length) {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        
            const renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
        
            const geometry = new THREE.BoxGeometry(depth, width, length);
            const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
            const cube = new THREE.Mesh(geometry, material);
            scene.add(cube);
        
            camera.position.z = 5;
        
            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }
            animate();
            
        }

        function fetchAndVisualizeBeam() {
            fetch('/calculate_beam', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    // Example dimensions, replace with actual input fields
                    length: 2,
                    width: 0.5,
                    height: 0.5
                })
            })
            .then(response => response.json())
            .then(data => {
                visualizeBeam(data.depth, data.width, data.length);
            });
        }
        
        // Example call, replace with actual data from backend
        visualizeBeam(1, 1, 1);
        </script>
        


</body>
</html>